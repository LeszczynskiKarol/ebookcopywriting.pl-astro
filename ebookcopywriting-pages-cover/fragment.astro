---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';
import BuyButton from '../components/BuyButton.astro';
const PREVIEW_PDF_URL = 'https://www.ebookcopywriting.pl/copywriting-360-preview.pdf';
---
<Layout title="Fragment ebooka Copywriting 360Â° â€” przeczytaj za darmo" description="Zajrzyj do Å›rodka ebooka Copywriting 360Â°. Przeczytaj peÅ‚ny rozdziaÅ‚ za darmo.">
<Navbar />
<main class="min-h-screen bg-slate-50 pt-20">

  <!-- Header z okÅ‚adkÄ… -->
  <section class="bg-navy-900 text-white py-16 md:py-20 relative overflow-hidden">
    <div class="absolute inset-0 grid-pattern opacity-40"></div>
    <div class="max-w-5xl mx-auto px-4 relative z-10">
      <div class="grid md:grid-cols-3 gap-10 items-center">
        <!-- Cover miniatura -->
        <div class="hidden md:flex justify-center">
          <img
            src="/cover-1.webp"
            alt="OkÅ‚adka ebooka Copywriting 360Â°"
            class="w-[200px] rounded-xl shadow-2xl shadow-primary-900/40 border border-white/10 transform -rotate-2"
            width="200"
            height="283"
            loading="eager"
          />
        </div>
        <!-- Tekst -->
        <div class="md:col-span-2 text-center md:text-left">
          <span class="badge bg-primary-500/15 text-primary-300 border border-primary-500/25 mb-4">ðŸ“– Darmowy fragment</span>
          <h1 class="text-3xl md:text-4xl font-bold mb-4">
            <span class="font-display italic text-primary-400">Copywriting 360Â°</span> â€” zajrzyj do Å›rodka
          </h1>
          <p class="text-slate-400 max-w-2xl">PoniÅ¼ej znajdziesz peÅ‚ny rozdziaÅ‚ ebooka do przeczytania za darmo. Przekonaj siÄ™, Å¼e to nie kolejny ogÃ³lnikowy poradnik.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- PDF viewer -->
  <section class="py-12">
    <div class="max-w-5xl mx-auto px-4">
      <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
        <div class="bg-navy-800 px-6 py-3 flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="flex gap-1.5">
              <div class="w-3 h-3 rounded-full bg-red-500"></div>
              <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
              <div class="w-3 h-3 rounded-full bg-green-500"></div>
            </div>
            <span class="text-sm text-slate-400">Fragment: Sztuka pisania nagÅ‚Ã³wkÃ³w</span>
          </div>
          <a href={PREVIEW_PDF_URL} target="_blank" rel="noopener" class="text-sm text-primary-400 hover:text-primary-300 transition-colors">Pobierz PDF â†—</a>
        </div>
        <iframe src={PREVIEW_PDF_URL} class="w-full h-[70vh] md:h-[80vh] border-0" title="Fragment ebooka" loading="lazy"></iframe>
      </div>
    </div>
  </section>

  <!-- CTA -->
  <section class="py-12 bg-white border-t border-slate-100">
    <div class="max-w-3xl mx-auto px-4 text-center">
      <h2 class="text-2xl font-bold text-slate-900 mb-4">Podoba Ci siÄ™? To zaledwie 1 z 16 rozdziaÅ‚Ã³w.</h2>
      <p class="text-slate-600 mb-8">PeÅ‚ny ebook to 194 strony praktycznej wiedzy o copywritingu.</p>
      <BuyButton text="Kup peÅ‚ny ebook za 49 zÅ‚" size="lg" />
    </div>
  </section>

</main>
<Footer />
<div id="loading-overlay" class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 hidden">
  <div class="bg-white rounded-2xl p-8 text-center shadow-2xl">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"></div>
    <p class="text-slate-700 font-medium">PrzekierowujÄ™ do pÅ‚atnoÅ›ci...</p>
  </div>
</div>
<script>
  const API_URL = 'https://452b6mr08j.execute-api.eu-central-1.amazonaws.com/prod';
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.buy-button').forEach((btn) => {
      btn.addEventListener('click', async () => {
        document.getElementById('loading-overlay').classList.remove('hidden');
        btn.disabled = true;
        try {
          const r = await fetch(`${API_URL}/create-checkout`, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({productId:btn.dataset.productId}) });
          const d = await r.json();
          if (d.url) window.location.href = d.url; else throw new Error(d.error||'Err');
        } catch(e) { document.getElementById('loading-overlay').classList.add('hidden'); btn.disabled=false; alert('WystÄ…piÅ‚ bÅ‚Ä…d.'); }
      });
    });
  });
</script>
</Layout>
